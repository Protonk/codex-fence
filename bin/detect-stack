#!/usr/bin/env bash
set -euo pipefail

# Thin wrapper delegating to the Rust implementation. Keep path resolution in
# sync with other bin helpers so scripts can rely on a consistent location.

script_dir=$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)
repo_root=$(cd "${script_dir}/.." >/dev/null 2>&1 && pwd)

binary="${repo_root}/target/release/detect-stack"
if [[ ! -x "${binary}" ]]; then
  binary="${repo_root}/target/debug/detect-stack"
fi

if [[ ! -x "${binary}" ]]; then
  echo "detect-stack binary not found. Build it with 'cargo build --release'." >&2
  exit 1
fi

exec "${binary}" "$@"
